# 项目名：代驾小程序v1.0
# 原创 原生 云开发
### 导入项目 配置项目过程

1. 打开微信开发者工具，导入项目；

2. 填写自己的APPID；

3. 开通云开发环境（请参考官方文档），右键`cloudfunctions`文件夹选择云环境， 上传 `cloudfunctions` 文件夹下所有的云函数，上传时选择 `上传并部署：云端安装依赖`；


4. 修改小程序资源配置：
- 4-1. 修改 `app.js` 大约在第19行的代码，如下：
```javascript
    wx.cloud.init({
        env: '(填写你自己云环境的ID)',
        traceUser: true,
    })
```
- 4-2. 修改 `me.js` 大约在第24行的代码，如下：
```javascript
	qqmapsdk = new QQMapWX({
		key: "腾讯地图的key"
	});
```


5. 点击`云开发`——>`更多`——>`内容管理`：开通内容管理，导入cms模型（注：导入cms成功后会自动创建一下数据表，只需手动修改数据表权限，如没有通过cms导入则需要手动创建数据表和手动修改数据表权限）；
- 5-1. 修改以下数据表权限；

```
    MiniAppInfo         //小程序管理信息表,权限：自定义规则：都为：true（可读、可写）
    OrderList           //订单表,权限：自定义规则：都为：true（可读、可写）
    DriverApplyList     //代驾司机表，权限：自定义规则：都为：true（可读、可写）
	DriverQrList        //代驾司机二维码,权限：所有用户可读，仅创建者可读写
    UserList            //用户表，权限：自定义规则：都为：true（可读、可写）
```
- 5-2. 修改存储的数据权限：自定义规则：都为：true（可读、可写）；

6. 在登录后，手动去数据库里设置第一个初始的管理员信息，在 `UserList`表里把admin修改为true,把 `level`字段修改为：2 (代表超级管理员，具有添加普通管理员的权限)、1 (代表普通管理员)、0（代表普通用户）；

```json
    "admin":true,
    "level":2,
```
- 6-1 修改权限之后就可以连续点击头像5次进入后台系统管理小程序了;

7. 在DriverApplyList、OrderList、表里都创建`地理位置`索引：_location（索引名），非唯一（索引属性），location（索引字段）


8. 编译运行。








